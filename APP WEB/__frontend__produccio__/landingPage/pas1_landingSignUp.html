    <!DOCTYPE html>

    <!-- NOTA: AQUEST ARXIU SERÀ EL QUE RENNOMBRAREM COM A INDEX.HTML-->
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MiApp.com | la mejor herramienta de lorem ipsum sit amet</title>



        <!-- estils per a totes les pagines -->
        <link rel="stylesheet" href="css/estilsGlobals.css"> 

        <!-- estils i javascript ESPECIFICS per a aquesta pagina (alguns potser es podran reutilitzar) -->
        <link rel="stylesheet" href="css/barraNavegacioSimple.css">
        <link rel="stylesheet" href="css/landing/estilsBannerInfoSimple.css">
        <link rel="stylesheet" href="css/landing/inputText.css">
        <link rel="stylesheet" href="css/landing/estilsCardsLanding.css">
        
        <script src="js/comprovaInputs.js"></script>
        <script src="js/inputCorreu.js"></script> <!--envia el correu a la bbdd del form inicial per veure is usuari hi hes o no i decidir segons diagrama-->
        <script src="js/barraTopRedirigeixLogin.js"></script>




    </head>
    <body>

        <!-- capsalera de la pagina. Per a la persona amb sessió iniciada en altres pagines es pot afegir una nav-->
        <header class="topPagina">
            <div>
                <img src="img/lletraPhiLaTeX_vectorial_blanca_clean.png" alt="logoNoCargó">
            </div>
            <div>
                <button id = "botoLogIn">Iniciar sesión</button>
            </div>
        </header>


        <hr>




        <!-- informació simplificada del producte -->
        <div id = "infoSimplificadaProducte">
            <div>
                <h1 style="display: none">MiApp</h1>
                <img src="img/MiAppFull.png" alt="MiApp" width="100%">
                <h2>La herramienta más completa, efectiva 
                    y económica para lorem ipsum consectetur adipisicing elit. Aut, quod temporibus. Minima dolor totam tempora.</h2>
            </div>
        </div>



        <!-- INPUT DE LECTURA DE CORREU -->
        <div class="input-container">
            <div class="input-wrapper">
                <input id="email" class="input-border" required>
                <label for="email" id = "email-labeleta" class="input-label">Dirección de correo</label>
            </div>
            <button id="botoEnviarCorreu" class="boto-enviar-correu">Regístrate</button> <!-- Agregado -->
        </div>









        <!-- cards productes -->
        <div class = "contenidorContenidorCarta">
            <div class="contenidor-carta">
                <article class="card">
                    <header>
                        <h1>producto 1</h1>
                    </header>
                    <section>
                        <p>Busca <span class = "emfasisCarta">lorem lorem</span> a partir de su chiquito ipsum. ¡El mejor sistema! Lorem, ipsum dol</p>
                            <ul style="display: grid; grid-template-columns: 1fr 1fr; font-size: .7em;">
                                <li><img src="img/rayo.png" alt="noCargó!" width="22%"><p>Rápido</p></li>
                                <li><img src="img/fuegoGlificon.png" alt="noCargó!" width="31%"><p>¡Sin lorem!</p></li>
                            </ul>
                    </section>
                    <section  class="ambBorder">
                        <img src="img/one-shot-imgSample.png" alt="no carrega" width="100%">
                    </section>
                    <footer>
                        <p>paquete: básico</p>
                    </footer>
                </article>
                
                <article class="card">
                    <header>
                        <h1>producto 2</h1>
                    </header>





                    <section>
                        <p>Haz exámenes  <span class = "emfasisCarta">con memoria de
                            progreso</span> filtrando items por:</p>
                            <ul style="display: grid; grid-template-columns: 1fr 1fr 1fr; font-size: .7em;">
                                <li><img src="img/gliphiconTemps.PNG" alt="noCargó!" width="30%"><p>Año</p></li>
                                <li><img src="img/fuegoGlificon.png" alt="noCargó!" width="31%"><p>Área</p></li>
                                <li><img src="img/gliphiconAmontonatPerDificultatPaint.png" alt="noCargó!" width="29%"><p>Dificultad</p></li>
                                <li><img src="img/conjuntBuitSimbolDeOpenOfficeGimp.png" alt="noCargó!" width="28%"><p>no contestados</p></li>
                                <li><img src="img/creuRojaPaintArtesa.png" alt="noCargó!" width="26%"><p>fallados</p></li>
                                <li><img src="img/fuegoGlificon.png" alt="noCargó!" width="28%"><p>lorem ipsum</p></li>
                            </ul>
                    </section>
                    <section  class = "contenidor-difuminat">
                        <img src="img/mobilFullRetallat.png" width="100%" alt="no carrega">
                    </section>
                    <footer>
                        <p>paquete: medio </p>
                    </footer>
                </article>

                <article class="card">
                    <header>
                        <h1>grafo ipsum</h1>
                    </header>
                    <section>
                        <p>Encuentra los <span class = "emfasisCarta">lorem ipsum</span> mediante el sistema de grafos ideado para lorem ipsum sit amet contocteour.</p>
                    
                    
                        <ul style="display: grid; grid-template-columns: 1fr 1fr; font-size: .7em;">
                            <li><img src="img/cervell_IA.png" alt="noCargó!" width="35%"><p>Clasificación por IA</p></li>
                            <li><img src="img/gliphiconTemps.PNG" alt="noCargó!" width="30%"><p>¡2010- 2024!</p></li>
                        </ul>
                    </section>
                    <section  class="ambBorder">
                        <img src="img/grafMostraLanding.PNG" alt="no carrega" width="100%">
                    </section>
                    <footer>
                        <p>paquete: Premium</p>
                    </footer>
                </article>
            </div>
        </div>


        


        <!-- SCRIPT SOLICITUD FETCH POST A SERVIDOR -ENVIEM CORREU I EL
        SERVIDOR ENS RETORNArà JSON DIENT SI L'USUARI HI ES O NO HI ES, per ara imprimit per consola-->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Obtener referencias a los elementos
                const emailInput = document.getElementById('email');
                const botoEnviarCorreu = document.getElementById('botoEnviarCorreu');
        
                // Agregar un event listener al botón
                botoEnviarCorreu.addEventListener('click', function obtinguesDadesBackend() {
                    // Obtener el valor del input
                    const email = emailInput.value;
        
                    //NOMES FAREM SOLICITUD AL SERVIDOR SI EL CORREU REUNEIX UNS MINIMS
                    if (correuApte(email)) {
                            
                        // -------  PAS 1: Envio la solicitud POST ------- 
                        fetch('http://localhost:8080/api/usuariExisteix', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',  //OBLIGAT --> DIU AL SERVIDOR QUE EL BODY DE LA PETICIO POST DEL CLIENT AL SERVIDOR SERA JSON (SERA DE FET {"email":"asd@asd.com"})
                                'Accept': 'application/json'        //OPCIONAL --> DIU QUE EL CLIENT ACCEPTARÀ DEL SERVIDOR UN JSON (EN AQUEST CAS, e.g, SERÀ {"{existeixUsuari: false}"})
                            },
                            body: JSON.stringify({ email: email }),             //ho recollira un hasmap de java al backend
                        }) // ------- PAS 2: AVALUO SI LA REPSOSTA ES EXITOSA (NO HA DONAT CODIS D'ERROR). SI I NOMÉS SI HO ÉS, CONVERTEIXO DADES A JSON.
                        .then(response => {
                            // Verificar si la respuesta es exitosa (CODIS EN RANG DE 200 A 299 SON RESPOSRTA EXITOSA, AL TRAMENT ES LLENÇA EXCPECIÓ QUE ES CAPTURARA EN EL CATCH). SI ES EXITOSA ENVIA LES DADES AL SEGUENT THEN
                            if (!response.ok) {
                                throw new Error('Error! La resposta de xarxa no ha sigut exitosa!');
                            }
                            return response.json(); // Convertir la respuesta a JSON
                        }) // ------- PAS 3: MANEJO LA RESPOSTA JSON -------
                        .then(dadesExitosesJSON => {
                            
                            console.log(dadesExitosesJSON); // Imprimir la respuesta en la consola
                            alert('Usuario existe: ' + dadesExitosesJSON.existeixUsuari+ " ||  teAccesArecursos: "+dadesExitosesJSON.teAccesArecursos);

                            if (dadesExitosesJSON.existeixUsuari) {
                                if (dadesExitosesJSON.teAccesArecursos) {

                                // -- vas al login --  
                                window.location.href = "pas2C_login.html";
                                localStorage.setItem('emailUsuariJaAmbAccesArecursos', email);
                                // --     --      --- 
                                } else {
                                    //-- anara fer que l'usuari introdueixi contrasenya -- 
                                    
                                    window.location.href = "pas2B_introduirContrasenya.html"
                                    // --     --      --- 
                                }
                            
                            } else { //no existeix usuaris
                                window.location.href = "pas2A_infoBenvinguda.html";  //si l'usuari no existeix cal comensar a dirli de posar la contra
                                sessionStorage.setItem('emailNouUsuari', email);
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            alert('Error en verificar usuari. Backend apagat probablement, o problemes de xarxa...');
                        });
            
                    } else {
                        alert("Comprueba el formato del correo, que no es correcto.")
                    }
                }); 
            });
        </script>
        
        




    
    </body>
    </html>
